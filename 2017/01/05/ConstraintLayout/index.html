<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  
  <title>ConstraintLayout（约束布局） | Flog&#39;blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="ConstraintLayout（约束布局）是谷歌新出的布局，在使用了一段时间后感觉 约束布局 非常的强大，这里将讲解一下 约束布局 的使用和几种情况下的方便之处。
1.安装如果使用 约束布局 那么在android studio中SDK Tools 中下载，然后再gradle中添加库的地址，版本的话看github上吧。我使用的时候版本更新的很快，所以没事就要看一下版本。
2.使用
“A Const">
<meta property="og:type" content="article">
<meta property="og:title" content="ConstraintLayout（约束布局）">
<meta property="og:url" content="https://chanchangxing.me/2017/01/05/ConstraintLayout/index.html">
<meta property="og:site_name" content="Flog'blog">
<meta property="og:description" content="ConstraintLayout（约束布局）是谷歌新出的布局，在使用了一段时间后感觉 约束布局 非常的强大，这里将讲解一下 约束布局 的使用和几种情况下的方便之处。
1.安装如果使用 约束布局 那么在android studio中SDK Tools 中下载，然后再gradle中添加库的地址，版本的话看github上吧。我使用的时候版本更新的很快，所以没事就要看一下版本。
2.使用
“A Const">
<meta property="og:image" content="https://chanchangxing.me/2017/01/05/ConstraintLayout/2.png">
<meta property="og:image" content="https://chanchangxing.me/2017/01/05/ConstraintLayout/3.png">
<meta property="og:image" content="https://chanchangxing.me/2017/01/05/ConstraintLayout/4.png">
<meta property="og:image" content="https://chanchangxing.me/2017/01/05/ConstraintLayout/5.png">
<meta property="og:image" content="https://chanchangxing.me/2017/01/05/ConstraintLayout/6.png">
<meta property="og:image" content="https://chanchangxing.me/2017/01/05/ConstraintLayout/7.png">
<meta property="og:updated_time" content="2017-03-22T03:26:59.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="ConstraintLayout（约束布局）">
<meta name="twitter:description" content="ConstraintLayout（约束布局）是谷歌新出的布局，在使用了一段时间后感觉 约束布局 非常的强大，这里将讲解一下 约束布局 的使用和几种情况下的方便之处。
1.安装如果使用 约束布局 那么在android studio中SDK Tools 中下载，然后再gradle中添加库的地址，版本的话看github上吧。我使用的时候版本更新的很快，所以没事就要看一下版本。
2.使用
“A Const">
<meta name="twitter:image" content="https://chanchangxing.me/2017/01/05/ConstraintLayout/2.png">
  
    <link rel="alternate" href="/atom.xml" title="Flog&#39;blog" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.ico">
  
  <link rel="stylesheet" href="/css/typing.css">
</head>

  
    <body>
  
      <div id="container" class="container">
        <article id="post-ConstraintLayout" class="article article-type-post" itemscope itemprop="blogPost">
  <header id="header" class="header">
  <nav id="main-nav" class="main-nav">
    
      <a class="main-nav-link" href="/">Home</a>
    
      <a class="main-nav-link" href="/archives">Archives</a>
    
      <a class="main-nav-link" href="/about">About</a>
    
  </nav>
  <nav id="sub-nav">
    
      <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
    
  </nav>
</header>

  <hr/>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      ConstraintLayout（约束布局）
    </h1>
  

      </header>
    
    <div class="article-entry typo" itemprop="articleBody">
      
        <p>ConstraintLayout（约束布局）是谷歌新出的布局，在使用了一段时间后感觉 约束布局 非常的强大，这里将讲解一下 约束布局 的使用和几种情况下的方便之处。</p>
<h5 id="1-安装"><a href="#1-安装" class="headerlink" title="1.安装"></a>1.安装</h5><p>如果使用 约束布局 那么在android studio中SDK Tools 中下载，然后再gradle中添加库的地址，版本的话看<a href="https://github.com/googlecodelabs/constraint-layout" target="_blank" rel="external">github</a>上吧。我使用的时候版本更新的很快，所以没事就要看一下版本。</p>
<h5 id="2-使用"><a href="#2-使用" class="headerlink" title="2.使用"></a>2.使用</h5><blockquote>
<p>“A ConstraintLayout is a ViewGroup which allows you to position and size widgets in a flexible way.”</p>
<p>ConstraintLayout是一个ViewGroup，它允许您以灵活的方式定位和调整小部件的大小。</p>
</blockquote>
<p>灵活的定位和调整小部件的大小是这个布局的主要功能。</p>
<blockquote>
<p>“For example, in order to position button B to the right of button A”</p>
<p>这个例子为了将button B 定位在 button A 的右边</p>
</blockquote>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">Button</span> <span class="attr">android:id</span>=<span class="string">"@+id/buttonA"</span> <span class="attr">...</span> /&gt;</span></div><div class="line">         <span class="tag">&lt;<span class="name">Button</span> <span class="attr">android:id</span>=<span class="string">"@+id/buttonB"</span> <span class="attr">...</span></span></div><div class="line">                 <span class="attr">app:layout_constraintLeft_toRightOf</span>=<span class="string">"@+id/buttonA"</span> /&gt;</div></pre></td></tr></table></figure>
<p>上面的xml是将button B 的左边定位在button A的右边。如果要加一点margin的话需要使用<code>android:layout_marginLeft</code></p>
<p><strong>注意：</strong>不要使用<code>layout_margin</code>，在新的界面预览中会有很大的问题。千万不要使用！</p>
<p>下面是可以使用的约束</p>
<ul>
<li><code>layout_constraintLeft_toLeftOf</code></li>
<li><code>layout_constraintLeft_toRightOf</code></li>
<li><code>layout_constraintRight_toLeftOf</code></li>
<li><code>layout_constraintRight_toRightOf</code></li>
<li><code>layout_constraintTop_toTopOf</code></li>
<li><code>layout_constraintTop_toBottomOf</code></li>
<li><code>layout_constraintBottom_toTopOf</code></li>
<li><code>layout_constraintBottom_toBottomOf</code></li>
<li><code>layout_constraintBaseline_toBaselineOf</code></li>
<li><code>layout_constraintBaseline_creator</code></li>
<li><code>layout_constraintStart_toEndOf</code></li>
<li><code>layout_constraintStart_toStartOf</code></li>
<li><code>layout_constraintEnd_toStartOf</code></li>
<li><code>layout_constraintEnd_toEndOf</code></li>
</ul>
<p><strong>注意：</strong> 1.<code>layout_constraintBaseline_toBaselineOf</code>是控件中文字的底部和参照物控件的文字的底部做约束。<code>layout_constraintBaseline_creator</code>官方文档没有做介绍，我在官网也搜索不到，所以我将两者做了对比，发现creator貌似是约束文字的顶部，但是我也发现了<code>layout_constraintLeft_creator</code>这一系列。所以这里让我非常疑惑，我觉得应该是更新了代码却没有更新文档。</p>
<p>​    2.约束可以以父布局做参照物布局，比如<code>layout_constraintLeft_toLeftOf=&quot;parent&quot;</code></p>
<p>当一种情况是登录按钮充满横屏。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">android.support.constraint.ConstraintLayout</span></span></div><div class="line">    <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></div><div class="line">    <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span>&gt;</div><div class="line"></div><div class="line">    <span class="tag">&lt;<span class="name">Button</span></span></div><div class="line">        <span class="attr">android:layout_width</span>=<span class="string">"0dp"</span></div><div class="line">        <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span></div><div class="line">        <span class="attr">android:text</span>=<span class="string">"ttt"</span></div><div class="line">        <span class="attr">app:layout_constraintLeft_toLeftOf</span>=<span class="string">"parent"</span></div><div class="line">        <span class="attr">app:layout_constraintRight_toRightOf</span>=<span class="string">"parent"</span> /&gt;</div><div class="line"><span class="tag">&lt;/<span class="name">android.support.constraint.ConstraintLayout</span>&gt;</span></div></pre></td></tr></table></figure>
<p>将<code>layout_width</code>设置为0dp是会充满界面。</p>
<p>接下来我们把<code>layout_width</code>设置为200dp，他将以200dp的宽度居中。</p>
<p>然后要介绍的是<code>layout_constraintHorizontal_bias</code>和<code>layout_constraintVertical_bias</code>，他们两个相对于垂直和水平做偏移。比较难解释，我们直接在上面的例子使用</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">android.support.constraint.ConstraintLayout</span></span></div><div class="line">    <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></div><div class="line">    <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span>&gt;</div><div class="line"></div><div class="line">    <span class="tag">&lt;<span class="name">Button</span></span></div><div class="line">        <span class="attr">android:layout_width</span>=<span class="string">"200dp"</span></div><div class="line">        <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span></div><div class="line">        <span class="attr">android:text</span>=<span class="string">"ttt"</span></div><div class="line">        <span class="attr">app:layout_constraintHorizontal_bias</span>=<span class="string">"0.3"</span></div><div class="line">        <span class="attr">app:layout_constraintLeft_toLeftOf</span>=<span class="string">"parent"</span></div><div class="line">        <span class="attr">app:layout_constraintRight_toRightOf</span>=<span class="string">"parent"</span> /&gt;</div><div class="line"><span class="tag">&lt;/<span class="name">android.support.constraint.ConstraintLayout</span>&gt;</span></div></pre></td></tr></table></figure>
<p>我们在<code>layout_constraintHorizontal_bias</code>设置了0.3，作用为将左侧的空间从50%替换成30%</p>
<img src="/2017/01/05/ConstraintLayout/2.png" alt="2.png" title="">
<p><code>layout_constraintVertical_bias</code>和<code>layout_constraintHorizontal_bias</code>作用相似。</p>
<p>在其他布局中，<code>visibility=&quot;gone&quot;</code>意味着这个控件在布局中消失了。但是在 约束布局 中，他意味着他变成了一个点，而其他将该控件作为参考物的控件的约束还是有作用的。</p>
<blockquote>
<p>For the layout pass, their dimension will be considered as if zero (basically, they will be resolved to a point)</p>
<p>If they have constraints to other widgets they will still be respected, but any margins will be as if equals to zero</p>
</blockquote>
<p>我认为采用这种机制是因为约束布局中控件与控件之间都是有联系的，当一个控件消失，那么其他控件的定位就会大乱，所以通过这种机制让其他布局能尽可能少的受到gone的影响</p>
<p>举个例子</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">android.support.constraint.ConstraintLayout</span></span></div><div class="line">        <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></div><div class="line">        <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span>&gt;</div><div class="line">        <span class="tag">&lt;<span class="name">TextView</span></span></div><div class="line">            <span class="attr">android:visibility</span>=<span class="string">"gone"</span></div><div class="line">            <span class="attr">android:id</span>=<span class="string">"@+id/textview"</span></div><div class="line">            <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span></div><div class="line">            <span class="attr">android:layout_width</span>=<span class="string">"wrap_content"</span></div><div class="line">            <span class="attr">android:text</span>=<span class="string">"aaa"</span></div><div class="line">            <span class="attr">app:layout_constraintLeft_toLeftOf</span>=<span class="string">"parent"</span> /&gt;</div><div class="line">        <span class="tag">&lt;<span class="name">Button</span></span></div><div class="line">            <span class="attr">android:layout_width</span>=<span class="string">"200dp"</span></div><div class="line">            <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span></div><div class="line">            <span class="attr">android:text</span>=<span class="string">"ttt"</span></div><div class="line">            <span class="attr">android:layout_marginLeft</span>=<span class="string">"20dp"</span></div><div class="line">            <span class="attr">app:layout_constraintLeft_toRightOf</span>=<span class="string">"@id/textview"</span> /&gt;</div><div class="line">    <span class="tag">&lt;/<span class="name">android.support.constraint.ConstraintLayout</span>&gt;</span></div></pre></td></tr></table></figure>
<img src="/2017/01/05/ConstraintLayout/3.png" alt="3.png" title="">
<p>你会发现button的还是有个20dp的距离，然后我们再设置另一个值<code>app:layout_goneMarginLeft=&quot;10dp&quot;</code>看结果</p>
<img src="/2017/01/05/ConstraintLayout/4.png" alt="4.png" title="">
<p>你会发现button对于边框的距离变成了10dp，如果设置<code>app:layout_goneMarginLeft=&quot;0dp&quot;</code>，那么就能达到和其他布局一样的效果。</p>
<p>接下来我们要看到<code>调整小部件的大小</code>的方法,<code>layout_constraintDimensionRatio</code>可以达到这种效果。他的用法也是通过比例来实现</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&lt;Button android:layout_width=&quot;wrap_content&quot;</div><div class="line">                  android:layout_height=&quot;0dp&quot;</div><div class="line">                  app:layout_constraintDimensionRatio=&quot;1:1&quot; /&gt;</div></pre></td></tr></table></figure>
<p>1：1的意思是width和height的比例为1：1，width:height，要注意的是被约束的尺寸需要设置为0dp。</p>
<p><strong>注意：</strong>当我用上述的代码，在界面预览的时候button的边界却不是1：1的，但是当我用另一个控件去被约束到button的right，发现另一个控件嵌近控件里面了，这个问题不知道如何解决，amazing！</p>
<img src="/2017/01/05/ConstraintLayout/5.png" alt="5.png" title="">
<p>当水平或者垂直方向都被约束，那么可以将<code>layout_width</code>和<code>layout_height</code>都设置为0dp，然后就可以使用ratio了，如果想将比例设置为height：width，那么需要这样<code>layout_constraintDimensionRatio=&quot;H,1:1&quot;</code></p>
<p>终于到了最后一个点了，关于chain，链。</p>
<p>这个很像铁索连舟，当你有三个控件类似这样的</p>
<img src="/2017/01/05/ConstraintLayout/6.png" alt="6.png" title="">
<p>注意下面的代码，3个button都是彼此双向连接的，除了最左边和最右边的parent，这就创建了一个链。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">android.support.constraint.ConstraintLayout</span></span></div><div class="line">    <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></div><div class="line">    <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span>&gt;</div><div class="line"></div><div class="line">    <span class="tag">&lt;<span class="name">Button</span></span></div><div class="line">        <span class="attr">android:id</span>=<span class="string">"@id/button"</span></div><div class="line">        <span class="attr">android:layout_width</span>=<span class="string">"wrap_content"</span></div><div class="line">        <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span></div><div class="line">        <span class="attr">android:text</span>=<span class="string">"aaa"</span></div><div class="line">        <span class="attr">app:layout_constraintBottom_toBottomOf</span>=<span class="string">"parent"</span></div><div class="line">        <span class="attr">app:layout_constraintLeft_toLeftOf</span>=<span class="string">"parent"</span></div><div class="line">        <span class="attr">app:layout_constraintRight_toLeftOf</span>=<span class="string">"@id/button2"</span></div><div class="line">        <span class="attr">app:layout_constraintTop_toTopOf</span>=<span class="string">"parent"</span> /&gt;</div><div class="line"></div><div class="line">    <span class="tag">&lt;<span class="name">Button</span></span></div><div class="line">        <span class="attr">android:id</span>=<span class="string">"@id/button2"</span></div><div class="line">        <span class="attr">android:layout_width</span>=<span class="string">"wrap_content"</span></div><div class="line">        <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span></div><div class="line">        <span class="attr">android:text</span>=<span class="string">"bbb"</span></div><div class="line">        <span class="attr">app:layout_constraintBottom_toBottomOf</span>=<span class="string">"parent"</span></div><div class="line">        <span class="attr">app:layout_constraintLeft_toRightOf</span>=<span class="string">"@id/button"</span></div><div class="line">        <span class="attr">app:layout_constraintRight_toLeftOf</span>=<span class="string">"@id/button3"</span></div><div class="line">        <span class="attr">app:layout_constraintTop_toTopOf</span>=<span class="string">"parent"</span> /&gt;</div><div class="line"></div><div class="line">    <span class="tag">&lt;<span class="name">Button</span></span></div><div class="line">        <span class="attr">android:id</span>=<span class="string">"@+id/button3"</span></div><div class="line">        <span class="attr">android:layout_width</span>=<span class="string">"wrap_content"</span></div><div class="line">        <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span></div><div class="line">        <span class="attr">android:text</span>=<span class="string">"ccc"</span></div><div class="line">        <span class="attr">app:layout_constraintBottom_toBottomOf</span>=<span class="string">"parent"</span></div><div class="line">        <span class="attr">app:layout_constraintLeft_toRightOf</span>=<span class="string">"@id/button2"</span></div><div class="line">        <span class="attr">app:layout_constraintRight_toRightOf</span>=<span class="string">"parent"</span></div><div class="line">        <span class="attr">app:layout_constraintTop_toTopOf</span>=<span class="string">"parent"</span> /&gt;</div><div class="line"></div><div class="line"><span class="tag">&lt;/<span class="name">android.support.constraint.ConstraintLayout</span>&gt;</span></div></pre></td></tr></table></figure>
<p>你可以在链的第一个控件上设置<code>layout_constraintHorizontal_chainStyle</code>，可以设置链中控件的位置，下面的图就是所有的类型</p>
<img src="/2017/01/05/ConstraintLayout/7.png" alt="7.png" title="">
<p>终于结束了！</p>
<p>对了，我用了业余时间封装了一个非常烂Recycleview，同事用了都说烂，连版本号都显得很烂。</p>
<p>希望你也能看看，如果真的很烂，麻烦也能star一下。<a href="https://github.com/chanchangxing/CCXRecyclerView" target="_blank" rel="external">折跃一下</a></p>

      
    </div>
    <footer class="article-footer">
      <ul class="article-meta">
        <li>
          <span class="label">Published Date:</span>
          <a href="/2017/01/05/ConstraintLayout/" class="article-date">
  <time datetime="2017-01-05T01:17:16.000Z" itemprop="datePublished">2017-01-05</time>
</a>

        </li>
        
          <li>
            <span class="label">Category:</span>
            
  <div class="article-category">
    <a class="article-category-link" href="/categories/android/">android</a>
  </div>


          </li>
        
        
        <hr/>
      </ul>
    </footer>
  </div>
  
    
<nav id="article-nav" class="article-nav">
  
    <a href="/2017/01/13/泛型/" id="article-nav-newer" class="article-nav-link-wrap newer">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          Recycleview
        
      </div>
    </a>
  
  
    <a href="/2017/01/05/20161228/" id="article-nav-older" class="article-nav-link-wrap older">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">纪录一个关于单例模式和Rxjava组合使用的bug。</div>
    </a>
  
</nav>


  
</article>


  <section id="comments">
    <!-- 多说评论框 start -->
    <div class="ds-thread" style="width:60%; margin:0 auto; border-radius: 5px" data-thread-key="post-ConstraintLayout" data-title="ConstraintLayout（约束布局）" data-url="https://chanchangxing.me/2017/01/05/ConstraintLayout/"></div>
    <!-- 多说评论框 end -->
    <!-- 多说公共JS代码 start (一个网页只需插入一次) -->
    <script type="text/javascript">
    var duoshuoQuery = {short_name:'chanchangxing'};
      (function() {
        var ds = document.createElement('script');
        ds.type = 'text/javascript';ds.async = true;
        ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
        ds.charset = 'UTF-8';
        (document.getElementsByTagName('head')[0] 
         || document.getElementsByTagName('body')[0]).appendChild(ds);
      })();
      </script>
    <!-- 多说公共JS代码 end -->
  </section>
  


      </div>
      
    <footer id="footer" class="post-footer footer">
      <hr/>
      <div id="footerContent" class="footer-content">
        <p>这家伙很懒，什么都没有留下</p>


      </div>
    </footer>

      

<script src="//cdn.bootcss.com/jquery/2.2.4/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/typing.js"></script>
<!--[if lt IE 9]><script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7/html5shiv.min.js"></script><![endif]-->







    </div>
  </body>
</html>
